pip install scapy
from scapy.all import *

def packet_callback(packet):
    print("\n=== PACKET CAPTURED ===")

    # Check if the packet has an IP layer
    if packet.haslayer(IP):
        src_ip = packet[IP].src
        dst_ip = packet[IP].dst
        proto = packet[IP].proto

        print(f"Source IP: {src_ip}")
        print(f"Destination IP: {dst_ip}")
        print(f"Protocol: {proto}")

        # Check for Raw Payload
        if packet.haslayer(Raw):
            try:
                print(f"Payload: {packet[Raw].load}")
            except:
                print("Payload: Unable to decode")
        else:
            print("Payload: None")
    else:
        print("Non-IP Packet Captured")

# Capture packets (CTRL + C to stop)
print("Starting packet sniffer... Press CTRL+C to stop.")
sniff(prn=packet_callback, store=False)
